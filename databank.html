<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>データバンク - ガイドあぷり</title>
    <style>
        /* 전역 모바일 우선 설정 */
        html {
            max-width: 414px;
            margin: 0 auto;
            background-color: #333;
            scroll-behavior: smooth;
        }

        /* 태블릿 최적화 */
        @media (min-width: 600px) and (max-width: 1024px) {
            html {
                max-width: 100%;
                background-color: #f9f9f9;
            }
            body {
                max-width: 100%;
                padding-top: 80px;
            }
            h1 {
                width: 100%;
                max-width: 100%;
                left: 0;
                transform: none;
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: sans-serif;
            line-height: 1.6;
            color: #333;
            text-align: center;
            background-color: #f9f9f9;
            padding-top: 80px;
            max-width: 414px;
            margin: 0 auto;
            overflow-x: hidden;
        }

        /* Header */
        h1 {
            position: fixed;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 414px;
            background-color: rgba(249, 249, 249, 0.95);
            backdrop-filter: blur(10px);
            padding: 15px 20px;
            border-bottom: 1px solid #ddd;
            z-index: 1000;
            display: grid;
            grid-template-columns: auto 1fr auto;
            align-items: center;
            gap: 10px;
        }

        .header-home-btn {
            padding: 8px 16px;
            background-color: #96ad51;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-size: 14px;
            transition: background-color 0.2s;
        }

        .header-home-btn:hover {
            background-color: #7a8f42;
        }

        .title-link {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            text-align: center;
        }

        /* Container */
        .container {
            padding: 20px;
        }

        /* Photo Gallery */
        .gallery-section {
            margin-bottom: 30px;
        }

        .gallery-section h2 {
            font-size: 24px;
            color: #333;
            margin-bottom: 20px;
        }

        .photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .photo-item {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .photo-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
        }

        .photo-item img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            transition: transform 0.2s;
        }

        .photo-item:hover img {
            transform: scale(1.05);
        }

        .photo-caption {
            padding: 10px;
            font-size: 14px;
            color: #666;
        }

        /* Modal for enlarged images */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100vw;
            height: 100vh;
            /* 핀치줌과 드래그를 위한 설정 */
            touch-action: manipulation;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content img {
            max-width: 100%;
            max-height: 100%;
            width: auto;
            height: auto;
            border-radius: 8px;
            /* 핀치줌과 드래그를 위한 설정 */
            touch-action: manipulation;
            user-select: none;
            -webkit-user-select: none;
            cursor: grab;
            /* transition 제거 - 줌 상태 유지를 위해 */
        }

        .modal-content img:active {
            cursor: grabbing;
        }

        .close {
            position: absolute;
            top: 20px;
            right: 30px;
            color: white;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
            transition: opacity 0.2s;
        }

        .close:hover {
            opacity: 0.7;
        }

        /* Info section */
        .info-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .info-section h3 {
            color: #333;
            margin-bottom: 10px;
        }

        .info-section p {
            color: #666;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <h1>
        <a href="index.html" class="header-home-btn">ホーム</a>
        <span class="title-link">データバンク</span>
        <div></div>
    </h1>

    <div class="container">
         <!--Info Section -->
        <div class="info-section">
            <h3>動画・PDF資料はこちら</h3>
            <!--<p>クロームブック分解に関する資料をここに保管しています。写真をクリックすると拡大表示されます。</p> -->
        </div>
    
        <!-- Photo Gallery -->
        <div class="gallery-section">
            <h2>写真ライブラリ</h2>
            <div class="photo-grid">
                <!-- 사진들 -->
                <div class="photo-item" onclick="openModal('images/data/cr1-lcd.jpg')">
                    <img src="images/data/cr1-lcd.jpg" alt="CR1 LCD">
                    <div class="photo-caption">CR1 LCDパネル</div>
                </div>
                
                <div class="photo-item" onclick="openModal('images/data/cr1-connector.jpg')">
                    <img src="images/data/cr1-connector.jpg" alt="CR1 Connector">
                    <div class="photo-caption">CR1 コネクタ</div>
                </div>
                
                <div class="photo-item" onclick="openModal('images/data/cr1-sub.jpg')">
                    <img src="images/data/cr1-sub.jpg" alt="CR1 Sub">
                    <div class="photo-caption">CR1 サブボード</div>
                </div>
                
                <div class="photo-item" onclick="openModal('images/data/cr1-a.jpg')">
                    <img src="images/data/cr1-a.jpg" alt="CR1 Component A">
                    <div class="photo-caption">CR1本体</div>
                </div>
                
                <div class="photo-item" onclick="openModal('images/data/cr1-antena.jpg')">
                    <img src="images/data/cr1-antena.jpg" alt="CR1 Antenna">
                    <div class="photo-caption">CR1 アンテナ線</div>
                </div>
                
                <div class="photo-item" onclick="openModal('images/data/cr1-mb.jpg')">
                    <img src="images/data/cr1-mb.jpg" alt="CR1 Motherboard">
                    <div class="photo-caption">CR1 システムボード</div>
                </div>
            </div>
        </div>

        <!-- Additional sections can be added here -->
        <div class="info-section">
            <h3>動画・PDF資料</h3>
            <p>追加予定</p>
        </div>
    </div>

    <!-- Modal for enlarged images -->
    <div id="imageModal" class="modal" onclick="closeModal()">
        <span class="close" onclick="closeModal()">&times;</span>
        <div class="modal-content">
            <img id="modalImage" src="" alt="Enlarged image">
        </div>
    </div>

    <script>
        let currentScale = 1;
        let currentX = 0;
        let currentY = 0;
        let isDragging = false;
        let startX = 0;
        let startY = 0;
        let initialDistance = 0;
        let initialScale = 1;

        function openModal(imageSrc) {
            const modal = document.getElementById('imageModal');
            const modalImage = document.getElementById('modalImage');
            
            modalImage.src = imageSrc;
            modal.style.display = 'block';
            
            // 초기값 리셋
            currentScale = 1;
            currentX = 0;
            currentY = 0;
            updateImageTransform();
            
            // 모바일에서 핀치줌을 위해 body scroll만 제한
            document.body.style.position = 'fixed';
            document.body.style.top = `-${window.scrollY}px`;
            document.body.style.width = '100%';
        }

        function closeModal() {
            const modal = document.getElementById('imageModal');
            modal.style.display = 'none';
            
            // Restore body scroll and position
            const scrollY = document.body.style.top;
            document.body.style.position = '';
            document.body.style.top = '';
            document.body.style.width = '';
            window.scrollTo(0, parseInt(scrollY || '0') * -1);
        }

        function updateImageTransform() {
            const modalImage = document.getElementById('modalImage');
            // transform을 즉시 적용 (transition 없이)
            modalImage.style.transition = 'none';
            modalImage.style.transform = `translate(${currentX}px, ${currentY}px) scale(${currentScale})`;
            // 다음 프레임에서 transition 복원 (더블탭 애니메이션용)
            requestAnimationFrame(() => {
                modalImage.style.transition = 'transform 0.3s ease-out';
            });
        }

        function getDistance(touches) {
            const dx = touches[0].clientX - touches[1].clientX;
            const dy = touches[0].clientY - touches[1].clientY;
            return Math.sqrt(dx * dx + dy * dy);
        }

        function getCenter(touches) {
            return {
                x: (touches[0].clientX + touches[1].clientX) / 2,
                y: (touches[0].clientY + touches[1].clientY) / 2
            };
        }

        // Touch events for pan and zoom
        const modalImage = document.getElementById('modalImage');

        modalImage.addEventListener('touchstart', function(e) {
            e.preventDefault();
            
            if (e.touches.length === 1) {
                // 한손가락 드래그 시작
                isDragging = true;
                startX = e.touches[0].clientX - currentX;
                startY = e.touches[0].clientY - currentY;
            } else if (e.touches.length === 2) {
                // 두손가락 핀치줌 시작
                isDragging = false;
                initialDistance = getDistance(e.touches);
                initialScale = currentScale; // 현재 스케일을 기준으로 시작
            }
        });

        modalImage.addEventListener('touchmove', function(e) {
            e.preventDefault();
            
            if (e.touches.length === 1 && isDragging) {
                // 한손가락 드래그
                currentX = e.touches[0].clientX - startX;
                currentY = e.touches[0].clientY - startY;
                updateImageTransform();
            } else if (e.touches.length === 2) {
                // 두손가락 핀치줌
                const currentDistance = getDistance(e.touches);
                const scale = (currentDistance / initialDistance) * initialScale;
                currentScale = Math.max(0.3, Math.min(8, scale)); // 0.3x ~ 8x 제한으로 확장
                updateImageTransform();
            }
        });

        modalImage.addEventListener('touchend', function(e) {
            if (e.touches.length === 0) {
                // 모든 손가락을 뗐을 때만 드래그 종료
                isDragging = false;
            }
            // 줌 상태는 유지 - 자동 리셋하지 않음
        });

        // Mouse events for desktop
        modalImage.addEventListener('mousedown', function(e) {
            e.preventDefault();
            isDragging = true;
            startX = e.clientX - currentX;
            startY = e.clientY - currentY;
        });

        modalImage.addEventListener('mousemove', function(e) {
            if (isDragging) {
                currentX = e.clientX - startX;
                currentY = e.clientY - startY;
                updateImageTransform();
            }
        });

        modalImage.addEventListener('mouseup', function(e) {
            isDragging = false;
        });

        // Wheel zoom for desktop
        modalImage.addEventListener('wheel', function(e) {
            e.preventDefault();
            const delta = e.deltaY > 0 ? 0.9 : 1.1;
            currentScale = Math.max(0.3, Math.min(8, currentScale * delta)); // 데스크톱도 동일한 범위
            updateImageTransform();
        });

        // Close modal when pressing Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeModal();
            }
        });

        // Double tap to reset zoom and position
        let lastTap = 0;
        modalImage.addEventListener('touchend', function(event) {
            const currentTime = new Date().getTime();
            const tapLength = currentTime - lastTap;
            if (tapLength < 300 && tapLength > 0 && event.touches.length === 0 && !isDragging) {
                // 더블탭으로만 줌과 위치 리셋 (아이폰처럼)
                const modalImage = document.getElementById('modalImage');
                modalImage.style.transition = 'transform 0.3s ease-out'; // 더블탭시만 애니메이션
                
                if (currentScale !== 1 || currentX !== 0 || currentY !== 0) {
                    // 확대되어 있거나 이동되어 있으면 리셋
                    currentScale = 1;
                    currentX = 0;
                    currentY = 0;
                } else {
                    // 기본 상태면 2배 확대
                    currentScale = 2;
                }
                modalImage.style.transform = `translate(${currentX}px, ${currentY}px) scale(${currentScale})`;
                
                // 애니메이션 후 transition 제거
                setTimeout(() => {
                    modalImage.style.transition = 'none';
                }, 300);
            }
            lastTap = currentTime;
        });

        // Prevent modal from closing when clicking on the image
        modalImage.addEventListener('click', function(event) {
            event.stopPropagation();
        });
    </script>
</body>
</html>
